{% load static %}

<!DOCTYPE html>
<html lang="uz">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Preview</title>
    <link rel="stylesheet" href="{% static 'documents/view.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body>
    <header class="header">
        <button id="menu-btn" class="menu-btn">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor" height="24" width="24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5">
                </path>
            </svg>
        </button>
        <img src="{% static 'img/logo.png' %}" alt="Logo" class="logo">
        <div class="header-texts">
            <h1><b>Ижро интизоми</b></h1>
            <p>Идоралараро ягона электрон тизими</p>
        </div>
    </header>

    <aside id="save-as" class="save-as">
        <div class="menu-save-con">
            <div class="top">
                <div class="mini-button"></div>
                <h3><b>Сохранить как</b></h3>
                <button class="close-btn" id="close-save-btn">✕</button>
            </div>

            <div class="items">
                <h4>Общий</h4>

                <div class="form-group">
                    <label>Имя файла</label>
                    <input type="text" value="{{ doc.document_code }}" class="text-input" />
                </div>

                <div class="form-group">
                    <label>Тип файла</label>
                    <select name="file-select" id="file-select" class="select-input">
                        <option value="pdf">PDF (*.pdf)</option>
                        <option value="jpg">JPG (*.jpg)</option>
                    </select>
                </div>

                <h4>Диапазон страниц</h4>

                <div class="radio-container">
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="page-range" value="all" checked />
                            <span>Все</span>
                        </label>
                        <label class="radio-label" style="margin-top: 20px;">
                            <input type="radio" name="page-range" value="current" />
                            <span>Текущая страница</span>
                        </label>
                    </div>

                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="page-range" value="specify" />
                            <span>Укажите страницы</span>
                        </label>
                    </div>
                </div>

                <h4>Характеристики</h4>

                <div class="checkbox-row">
                    <label class="checkbox-label">
                        <input type="checkbox" checked />
                        <span>Включить аннотации</span>
                    </label>

                    <label class="checkbox-label">
                        <input type="checkbox" />
                        <span>Включить комментарии</span>
                    </label>
                </div>
            </div>

            <div class="footer">
                <button class="save-btn" id="save-file-btn">Сохранить файл</button>
            </div>
        </div>
    </aside>

    <!-- Others Menu -->
    <aside id="others" class="others">
        <div class="mini-button"></div>
        <div class="menu-buttons-con">
            <a href="{{ doc.file.url }}" style="text-decoration: none;" download>
                <button>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24">
                        <path class="cls-1"
                            d="M11.55,17,5.09,9.66a.6.6,0,0,1,.45-1H8.67V2.6a.6.6,0,0,1,.6-.6h5.46a.6.6,0,0,1,.6.6V8.67h3.13a.6.6,0,0,1,.45,1L12.45,17A.6.6,0,0,1,11.55,17ZM3.11,20.18V21.6a.4.4,0,0,0,.4.4h17a.4.4,0,0,0,.4-.4V20.18a.4.4,0,0,0-.4-.4h-17A.4.4,0,0,0,3.11,20.18Z">
                        </path>
                    </svg>
                    <span>Yuklab olish</span>
                </button>
            </a>
            <button id="fullscreen-btn">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24">
                    <path class="cls-1"
                        d="M4.22,4.22H9.78V2H2V9.78H4.22ZM9.78,19.78H4.22V14.22H2V22H9.78ZM22,14.22H19.78v5.56H14.22V22H22ZM19.78,9.78H22V2H14.22V4.22h5.56Z">
                    </path>
                </svg>
                <span>To'liq ekran</span>
            </button>
            <button id="save-as-btn">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24">
                    <path class="cls-1"
                        d="M5 21H19C20.103 21 21 20.103 21 19V8C21 7.735 20.895 7.48 20.707 7.293L16.707 3.293C16.52 3.105 16.266 3 16 3H5C3.897 3 3 3.897 3 5V19C3 20.103 3.897 21 5 21ZM15 19H9V14H15V19ZM13 7H11V5H13V7ZM5 5H7V9H15V5H15.586L19 8.414L19.001 19H17V14C17 12.897 16.103 12 15 12H9C7.897 12 7 12.897 7 14V19H5V5Z">
                    </path>
                </svg>
                <span>Saqlash</span>
            </button>
            <button>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24">
                    <path class="cls-1"
                        d="M20,6H18V2H6V6H4A2,2,0,0,0,2,8v9a2,2,0,0,0,2,2H6v3H18V19h2a2,2,0,0,0,2-2V8A2,2,0,0,0,20,6ZM8,4h8V6H8Zm8,16H8V16h8Zm4-3H18V14H6v3H4V8H20Zm-4-7h2v2H16Zm-3,0h2v2H13Z">
                    </path>
                </svg>
                <span>Pechat berish</span>
            </button>
            <div style="width: 100%; border-bottom: 0.5px solid #dedfdf; margin-top: 5px;"></div>
            <button>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24">
                    <path class="cls-1"
                        d="M12,8a4,4,0,1,0,4,4A4,4,0,0,0,12,8Zm0,6a2,2,0,1,1,2-2A2,2,0,0,1,12,14Zm8.42-.6-.5-.29a7.74,7.74,0,0,0,0-2.22l.5-.29a2,2,0,0,0,.73-2.74l-1-1.72a2.06,2.06,0,0,0-2.73-.74l-.53.31A8.07,8.07,0,0,0,15,4.6V4a2,2,0,0,0-2-2H11A2,2,0,0,0,9,4v.6A8.07,8.07,0,0,0,7.1,5.71L6.57,5.4a2.07,2.07,0,0,0-2.73.73l-1,1.73a2,2,0,0,0,.73,2.74l.5.29a7.74,7.74,0,0,0,0,2.22l-.5.29a2,2,0,0,0-.73,2.74l1,1.73a2.05,2.05,0,0,0,2.72.73l.53-.31A8.07,8.07,0,0,0,9,19.4V20a2,2,0,0,0,2,2h2a2,2,0,0,0,2-2v-.6a8.07,8.07,0,0,0,1.9-1.11l.53.31a2.07,2.07,0,0,0,2.73-.73l1-1.73A2,2,0,0,0,20.42,13.4Zm-2.59-2.78A5.86,5.86,0,0,1,18,12a5.92,5.92,0,0,1-.17,1.38,1,1,0,0,0,.47,1.11l1.12.64-1,1.73-1.15-.66a1,1,0,0,0-1.19.15,6.05,6.05,0,0,1-2.38,1.39,1,1,0,0,0-.71,1V20H11V18.7a1,1,0,0,0-.71-1,6.05,6.05,0,0,1-2.38-1.39,1,1,0,0,0-.69-.28,1,1,0,0,0-.5.13l-1.14.67-1-1.73,1.12-.65a1,1,0,0,0,.47-1.11A5.92,5.92,0,0,1,6,12a5.86,5.86,0,0,1,.17-1.38A1,1,0,0,0,5.7,9.51L4.58,8.86l1-1.73,1.15.67a1,1,0,0,0,1.19-.15,6.05,6.05,0,0,1,2.38-1.39,1,1,0,0,0,.71-1V4h2V5.3a1,1,0,0,0,.71,1,6.05,6.05,0,0,1,2.38,1.39,1,1,0,0,0,1.19.15l1.14-.66,1,1.73-1.12.64A1,1,0,0,0,17.83,10.62Z">
                    </path>
                </svg>
                <span>Sozlamalar</span>
            </button>
        </div>
    </aside>

    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar">
        <h3>{{ doc.document_code }}</h3>
        <h5>{{ doc.ducument_son }}-сонли</h5>
        <h5 class="date">{{ doc.ariza_berilgan }}</h5>
        <ul>
            <li>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor" height="32" width="32">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h1.5m-1.5 3h1.5m-1.5 3h1.5m3-6H15m-1.5 3H15m-1.5 3H15M9 21v-3.375c0-.621.504-1.125 1.125-1.125h3.75c.621 0 1.125.504 1.125 1.125V21">
                    </path>
                </svg>
                <span class="text">{{ doc.bergan_tashkilot }}</span>
            </li>
            <li class="item">
                <div class="title">
                    <p>Ким томонидан имзоланган</p>
                </div>
                <div class="texts">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" height="22" width="22">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z">
                        </path>
                    </svg>
                    <span class="text">{{ doc.imzolagan }}</span>
                </div>
            </li>
            <li class="item">
                <div class="title">
                    <p>Ҳужжат ижрочиси</p>
                </div>
                <div class="texts">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" height="22" width="22">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z">
                        </path>
                    </svg>
                    <span class="text">{{ doc.ijrochi }}</span>
                </div>
            </li>
            <li class="item">
                <div class="title">
                    <p>ЭРИ берган ташкилот</p>
                </div>
                <div class="texts">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" height="22" width="22">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h1.5m-1.5 3h1.5m-1.5 3h1.5m3-6H15m-1.5 3H15m-1.5 3H15M9 21v-3.375c0-.621.504-1.125 1.125-1.125h3.75c.621 0 1.125.504 1.125 1.125V21">
                        </path>
                    </svg>
                    <span class="text">{{ doc.eri_bergan }}</span>
                </div>
            </li>
            <li class="item">
                <div class="title">
                    <p>ЭРИ амал қилиш муддати</p>
                </div>
                <div class="texts">
                    <svg viewBox="0 0 24 24" height="22" width="22">
                        <path fill="none" stroke-linejoin="round" stroke-linecap="round" stroke-width="2"
                            stroke="currentColor"
                            d="M5 4h14a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V6a2 2 0 012-2zM16 2v4M8 2v4M3 10h18">
                        </path>
                    </svg>
                    <span class="text">{{ doc.eri_amal_qilish_b }} - {{ doc.eri_tugash }}</span>
                </div>
            </li>
            <li class="item">
                <div class="title">
                    <p>Имзоланган ҳужжат</p>
                </div>
                <div class="texts">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor"
                        viewBox="0 0 16 16">
                        <path
                            d="M5.5 7a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zM5 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5" />
                        <path
                            d="M9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.5zm0 1v2A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z" />
                    </svg>
                    <span class="text">{{ doc.imzolagan_h }}</span>
                </div>
            </li>
        </ul>
    </aside>

    <!-- Main Content -->
    <div class="main">
        <div class="control-panel">
            <button id="other-btn">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor" height="22" width="22">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path>
                </svg>
            </button>
            <div class="vr"></div>
            <button>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="22" width="22">
                    <path class="cls-1"
                        d="M19.78,2H4.22A2.23,2.23,0,0,0,2,4.22V19.78A2.23,2.23,0,0,0,4.22,22H19.78A2.23,2.23,0,0,0,22,19.78V4.22A2.23,2.23,0,0,0,19.78,2ZM7.56,19.78H4.22V4.22H7.56Zm2.22,0V4.22h10V19.78Z">
                    </path>
                </svg>
            </button>
            <button>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="22" width="22">
                    <path class="cls-1"
                        d="M10.75,10.43v.7a4,4,0,0,0-.84.5l-.61-.36a.45.45,0,0,0-.61.16L7.82,13a.44.44,0,0,0,.17.6H8l.6.35a4.18,4.18,0,0,0,0,1L8,15.3a.44.44,0,0,0-.17.58l.89,1.53a.45.45,0,0,0,.61.16l.61-.36a4,4,0,0,0,.84.5v.71a.46.46,0,0,0,.45.44H13a.44.44,0,0,0,.44-.44v-.71a3.39,3.39,0,0,0,.84-.5l.62.36a.45.45,0,0,0,.61-.16l.89-1.53a.45.45,0,0,0-.17-.61l-.6-.35a4.18,4.18,0,0,0,0-1l.6-.35a.44.44,0,0,0,.17-.6h0l-.89-1.54a.45.45,0,0,0-.61-.16l-.62.36a3.39,3.39,0,0,0-.84-.5v-.7A.44.44,0,0,0,13,10H11.2A.45.45,0,0,0,10.75,10.43Zm1.35,2.22a1.78,1.78,0,1,1-1.77,1.79h0a1.78,1.78,0,0,1,1.75-1.78Zm7.84-4V8.6a.84.84,0,0,0-.2-.29l-6-6a1.15,1.15,0,0,0-.29-.2h-.1A.79.79,0,0,0,13.06,2H6A2,2,0,0,0,4,4V20a2,2,0,0,0,2,2H18a2,2,0,0,0,2-2V8.94A1,1,0,0,0,19.94,8.69ZM18,20H6V4h6l6,6Z">
                    </path>
                </svg>
            </button>
            <div class="vr"></div>
            <div class="zoom-container">
                <p>100%</p>
                <button>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" height="14" width="14">
                        <path class="cls-1" d="M9,3.5l-3,3-3-3-1,1,4,4,4-4Z"></path>
                    </svg>
                </button>
                <button id="zoom-out">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="22" width="22">
                        <path class="cls-1"
                            d="M7,11H17v2H7Zm15,1A10,10,0,1,1,12,2,10,10,0,0,1,22,12Zm-2,0a8,8,0,1,0-8,8A8,8,0,0,0,20,12Z">
                        </path>
                    </svg>
                </button>
                <button id="zoom-in">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="22" width="22">
                        <path class="cls-1"
                            d="M13,11h4v2H13v4H11V13H7V11h4V7h2Zm9,1A10,10,0,1,1,12,2,10,10,0,0,1,22,12Zm-2,0a8,8,0,1,0-8,8A8,8,0,0,0,20,12Z">
                        </path>
                    </svg>
                </button>
            </div>
            <div class="vr"></div>
            <button id="rotate-cw">
                <svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" height="22" width="22" fill="#9196a9">
                    <path
                        d="M4.84116789,10.6404137 C4.46186271,10.6404137 3.96297997,10.9126703 3.804829,11.1798615 C3.56953121,11.5774827 3.81897258,11.930783 3.98998135,12.1055337 L4.90417112,13.043869 C5.82350401,13.9872696 6.74283689,14.9294038 7.66345556,15.8690054 C9.43397498,17.6696974 11.5349399,18.024264 13.7413389,16.8921834 C15.5478601,15.9639786 16.5301962,14.4798639 16.66006,12.4816276 C16.7089197,11.7281735 16.7024908,10.9506595 16.6947761,10.1984717 L16.689633,9.37283798 C16.689633,9.37283798 16.6909188,7.17705742 16.6857756,6.07663452 C16.6844899,5.86516085 16.6214866,5.70560586 16.4993375,5.60176848 C16.3797599,5.49919742 16.1971792,5.44474611 15.9721676,5.44474611 L15.9631671,5.44474611 C15.5607179,5.44601242 15.1454109,5.73346466 15.1454109,6.20959701 L15.1441251,9.50833309 C15.1441251,9.63876296 15.1454109,9.78945378 15.0618352,9.92494889 C14.8496814,10.2630535 14.5938112,10.4302064 14.2955101,10.4302064 C13.8622022,10.4302064 13.5960457,10.0515798 13.5021837,9.88949223 C13.4288942,9.77045914 13.43018,9.63496403 13.4314658,9.54505606 L13.4314658,8.23949103 C13.4327516,6.96431743 13.4327516,5.68661122 13.4288942,4.41017131 C13.4327516,4.10372442 13.1254501,3.7656198 12.6239958,3.74789147 C12.3899838,3.75675564 12.2151177,3.84666361 12.1199699,3.9391042 C11.9605332,4.09359395 11.8923868,4.29493715 11.8949584,4.42663333 C11.9232456,5.8993512 11.9219598,7.41765621 11.9193882,8.90050456 L11.9193882,9.48427321 C11.9193882,9.61090415 11.9103878,9.74260033 11.8460987,9.86923128 C11.7830955,9.9933296 11.5426546,10.3985486 11.0939173,10.3985486 C10.6541804,10.3985486 10.3725946,10.0249873 10.3083056,9.89329116 C10.2337303,9.7375351 10.2337303,9.5767138 10.2337303,9.44881654 L10.2337303,7.43031931 C10.2337303,6.08423238 10.2337303,4.74067807 10.229873,3.39585745 C10.2388734,3.22743829 10.1758702,3.06914962 10.0562926,2.94378498 C9.89557009,2.77663214 9.65770074,2.68419155 9.38768689,2.68419155 C8.82708669,2.68419155 8.52621411,3.11726937 8.52492833,3.43086831 C8.52364255,4.69564025 8.51721365,5.96041219 8.51721365,7.22518413 C8.51721365,7.82208895 8.52364255,8.41899377 8.52364255,9.01589859 C8.52364255,9.13366537 8.51850943,9.25396477 8.45735305,9.35780215 C8.39105403,9.4731364 8.1480416,9.87328687 7.69416164,9.87328687 C7.28784506,9.87328687 6.99210511,9.55588901 6.91753134,9.41152442 C6.84295758,9.27222507 6.8378144,9.10887164 6.84038596,8.97210491 L6.84038596,4.97863388 C6.84295758,4.25604388 6.53693238,3.72869413 5.94903583,3.72869413 C5.72659584,3.72869413 5.5466867,3.81733578 5.44511148,3.92243948 C5.30269883,4.07186399 5.23897137,4.28586812 5.24154293,4.52240487 C5.2697516,5.66876264 5.26460898,6.81765303 5.26460898,7.96527711 C5.26460898,8.47742364 5.26975159,8.98830386 5.27489421,9.50045038 C5.27489421,9.66380381 5.27489421,9.82462462 5.19775254,9.97531544 C5.08388846,10.1952548 4.85116261,10.6366493 4.3884001,10.6391156 C4.20848955,10.6391156 4.84116789,10.6404137 4.84116789,10.6404137 Z">
                    </path>
                </svg>
            </button>
            <button id="rotate-ccw">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" height="22" width="22">
                    <g fill="none" fill-rule="evenodd">
                        <g fill="#868E96">
                            <g>
                                <path
                                    d="M18.17,13.39 L16.28,13.39 L16.28,16.22 L13.44,16.22 L13.44,18.11 L16.28,18.11 L16.28,21 L18.17,21 L18.17,18.11 L21,18.11 L21,16.22 L18.17,16.22 L18.17,13.39 Z M4,18.11 L6.83,18.11 L6.83,16.22 L4.94,16.22 L4.94,14.34 L3.05,14.34 L3.05,17.17 C3.05,17.4210458 3.15039276,17.6616665 3.32884571,17.838241 C3.50729865,18.0148155 3.74896838,18.1126707 4,18.11 Z M18.17,3.94 C18.1382202,3.41127612 17.6996773,2.99904577 17.17,2.99999835 L14.39,2.99999835 L14.39,4.89 L16.28,4.89 L16.28,6.78 L18.17,6.78 L18.17,3.94 Z M4.94,4.89 L6.83,4.89 L6.83,3 L3.99999804,3 C3.74047377,2.9834001 3.48566705,3.07505767 3.29618264,3.25317302 C3.10669822,3.43128837 2.99946966,3.67994396 2.99999804,3.94 L2.99999804,6.78 L4.94,6.78 L4.94,4.89 Z M3.05,8.67 L4.94,8.67 L4.94,12.45 L3.05,12.45 L3.05,8.67 Z M16.28,8.67 L18.17,8.67 L18.17,11.5 L16.28,11.5 L16.28,8.67 Z M8.72,3 L12.5,3 L12.5,4.89 L8.72,4.89 L8.72,3 Z M8.72,16.22 L11.55,16.22 L11.55,18.11 L8.72,18.11 L8.72,16.22 Z">
                                </path>
                            </g>
                        </g>
                    </g>
                </svg>
            </button>
        </div>

        <div class="doc-con">
            {% if pdf_preview %}
            <img id="pdf-img" src="{{ pdf_preview }}" alt="PDF Preview">
            {% else %}
            <div class="no-preview">
                <p>PDF rasm mavjud emas</p>
            </div>
            {% endif %}
        </div>
    </div>

    <script>
        // Sidebar toggle
        const menuBtn = document.getElementById('menu-btn');
        menuBtn.onclick = () => {
            document.body.classList.toggle('sidebar-open');
        };

        // Others menu toggle
        const othersBtn = document.getElementById('other-btn');
        othersBtn.onclick = () => {
            document.body.classList.remove('save-as-open');
            document.body.classList.toggle('others-open');
        };

        // Save as dialog toggle
        const saveAsBtn = document.getElementById('save-as-btn');
        if (saveAsBtn) {
            saveAsBtn.onclick = () => {
                document.body.classList.remove('others-open');
                document.body.classList.toggle('save-as-open');
            };
        }

        // Close save as dialog
        const closeSaveBtn = document.getElementById('close-save-btn');
        if (closeSaveBtn) {
            closeSaveBtn.onclick = () => {
                document.body.classList.remove('save-as-open');
            };
        }

        // Fullscreen toggle
        const fsBtn = document.getElementById('fullscreen-btn');
        fsBtn.onclick = () => {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch((err) => {
                    alert(`Fullscreen rejimga o'tilmadi: ${err.message}`);
                });
            } else {
                document.exitFullscreen();
            }
        };

        // PDF image manipulation
        {% if pdf_preview %}
        const img = document.getElementById('pdf-img');
        let scale = 1;
        let rotation = 0;
        let translateX = 0;
        let translateY = 0;
        let isDragging = false;
        let startX = 0;
        let startY = 0;
        let rafId = null;

        function applyTransform() {
            img.style.transform = `translate3d(${translateX}px, ${translateY}px, 0) scale(${scale}) rotate(${rotation}deg)`;
            rafId = null;
        }

        function requestUpdate() {
            if (rafId) return;
            rafId = requestAnimationFrame(applyTransform);
        }

        document.getElementById('zoom-in').onclick = () => {
            scale += 0.1;
            requestUpdate();
        };

        document.getElementById('zoom-out').onclick = () => {
            scale = Math.max(0.1, scale - 0.1);
            requestUpdate();
        };

        document.getElementById('rotate-cw').onclick = () => {
            rotation += 90;
            requestUpdate();
        };

        document.getElementById('rotate-ccw').onclick = () => {
            rotation -= 90;
            requestUpdate();
        };

        img.addEventListener('dragstart', e => e.preventDefault());

        img.addEventListener('mousedown', (e) => {
            isDragging = true;
            startX = e.clientX - translateX;
            startY = e.clientY - translateY;
            img.style.cursor = 'grabbing';
        });

        document.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            translateX = e.clientX - startX;
            translateY = e.clientY - startY;
            requestUpdate();
        });

        document.addEventListener('mouseup', () => {
            isDragging = false;
            img.style.cursor = 'grab';
        });

document.getElementById('save-file-btn').onclick = async () => {
    const nameInput = document.querySelector('.text-input');
            const type = document.getElementById('file-select').value;

            let fileName = nameInput.value.trim();
            if (!fileName) {
                alert("Имя файла не указано");
            return;
    }

            let fileUrl = "";
            let ext = "";

            if (type === "pdf") {
                fileUrl = "{{ doc.file.url }}";
            ext = ".pdf";
    } else if (type === "jpg") {
                fileUrl = "{{ pdf_preview }}";
            ext = ".jpg";
    }

            try {
        const response = await fetch(fileUrl);
            const blob = await response.blob();

            const blobUrl = URL.createObjectURL(blob);

            const a = document.createElement("a");
            a.href = blobUrl;
            a.download = fileName + ext;

            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);

            URL.revokeObjectURL(blobUrl);
    } catch (e) {
                alert("Faylni yuklab bo‘lmadi");
            console.error(e);
    }
};

    {% endif %}
    </script>

</body>

</html>